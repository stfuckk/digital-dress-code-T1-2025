# –û—Ç—á–µ—Ç –ø–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥—É –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

## üìä –ö—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞

**–î–∞—Ç–∞:** 25 –æ–∫—Ç—è–±—Ä—è 2025  
**–¶–µ–ª—å:** –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∫–æ–¥–∞ –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### –¢–µ–∫—É—â–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **–î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:** ~15 FPS, inference ~25 –º—Å
- **–û–∂–∏–¥–∞–µ–º–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ:** +20-30% FPS (–¥–æ 18-20 FPS), inference ~18-22 –º—Å –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ WebGL

---

## üóëÔ∏è –£–¥–∞–ª–µ–Ω–Ω—ã–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ–∞–π–ª—ã

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
1. ‚úÖ **StatsPanel.vue** - –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–ª—Å—è, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –≤ template
2. ‚úÖ **PresentationMode.vue** - –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –Ω–∏–≥–¥–µ
3. ‚úÖ **UserInfo.vue** - —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∑–∞–º–µ–Ω–µ–Ω –Ω–∞ –ø—Ä—è–º–æ–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —á–µ—Ä–µ–∑ `drawUserInfoOnCanvas()`

### –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏
4. ‚úÖ **src/lib/maskRefiner.js** - TensorFlow.js –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å

### –í–æ—Ä–∫–µ—Ä—ã
5. ‚úÖ **src/workers/comp.worker.js** - –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –∫–æ–º–ø–æ–∑–∏—Ç–æ—Ä –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è
6. ‚úÖ **src/workers/simple-comp.worker.js** - —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –∫–æ–º–ø–æ–∑–∏—Ç–æ—Ä –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è

### –ò–º–ø–æ—Ä—Ç—ã
7. ‚úÖ **–£–¥–∞–ª–µ–Ω –∏–º–ø–æ—Ä—Ç StatsPanel** –∏–∑ VideoCanvas.vue
8. ‚úÖ **–£–¥–∞–ª–µ–Ω –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∏–º–ø–æ—Ä—Ç watch** –∏–∑ VideoCanvas.vue

---

## ‚ö° –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### 1. rvm.worker.js (ML Worker)

#### 1.1 –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Ç–µ–Ω–∑–æ—Ä–æ–≤
```javascript
// –î–û: —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ canvas –∫–∞–∂–¥—ã–π –∫–∞–¥—Ä
const canvas = new OffscreenCanvas(width, height);

// –ü–û–°–õ–ï: –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ canvas
let cachedCanvas = null;
if (!cachedCanvas || cachedCanvas.width !== width) {
  cachedCanvas = new OffscreenCanvas(width, height);
}
```
**–≠—Ñ—Ñ–µ–∫—Ç:** –£–º–µ–Ω—å—à–µ–Ω–∏–µ GC –ø–∞—É–∑, —ç–∫–æ–Ω–æ–º–∏—è ~2-3 –º—Å –Ω–∞ –∫–∞–¥—Ä

#### 1.2 –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ü–∏–∫–ª–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–∏–∫—Å–µ–ª–µ–π
```javascript
// –î–û: –¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏
tensorData[i] = pixels[p] / 255.0;

// –ü–û–°–õ–ï: –ø—Ä–µ–¥–≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –∏ –±–∏—Ç–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
const inv255 = 1.0 / 255.0;
const p = i << 2; // –±—ã—Å—Ç—Ä–µ–µ —á–µ–º i * 4
tensorData[i] = pixels[p] * inv255;
```
**–≠—Ñ—Ñ–µ–∫—Ç:** –£—Å–∫–æ—Ä–µ–Ω–∏–µ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥–∞ –Ω–∞ ~15-20%

#### 1.3 –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –º–æ—Ä—Ñ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
```javascript
// –î–û: –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö –ø–∏–∫—Å–µ–ª–µ–π (kernel 3x3)
for (let i = 0; i < size; i++) { /* –ø—Ä–æ—Ü–µ—Å—Å */ }

// –ü–û–°–õ–ï: –ø—Ä–æ–ø—É—Å–∫ –æ—á–µ–≤–∏–¥–Ω—ã—Ö fg/bg –ø–∏–∫—Å–µ–ª–µ–π (kernel 2x2)
if (currentVal > 0.95 || currentVal < 0.05) {
  result[idx] = currentVal;
  continue;
}
```
**–≠—Ñ—Ñ–µ–∫—Ç:** –£—Å–∫–æ—Ä–µ–Ω–∏–µ –ø–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞ ~40%, –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–æ–ª—å–∫–æ –∫—Ä–∞–µ–≤

#### 1.4 –£–ª—É—á—à–µ–Ω–Ω–∞—è temporal stabilization
```javascript
// –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
const TEMPORAL_ALPHA = 0.7;    // –±—ã–ª–æ 0.65
const RESET_INTERVAL = 180;     // –±—ã–ª–æ 150
const EDGE_GAMMA = 0.85;        // –±—ã–ª–æ 0.82
```
**–≠—Ñ—Ñ–µ–∫—Ç:** –õ—É—á—à–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –º–∞—Å–∫–∏, –º–µ–Ω—å—à–µ –¥—Ä–æ–∂–∞–Ω–∏—è

#### 1.5 –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±—É—Ñ–µ—Ä–æ–≤ –ø—Ä–∏ reset
```javascript
// –ù–µ —É–¥–∞–ª—è–µ–º –±—É—Ñ–µ—Ä—ã –ø—Ä–∏ reset, –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º
// tensorCache.inputBuffer = null; // –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ
// cachedCanvas = null;             // –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ
```
**–≠—Ñ—Ñ–µ–∫—Ç:** –ë—ã—Å—Ç—Ä—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫, –º–µ–Ω—å—à–µ –∞–ª–ª–æ–∫–∞—Ü–∏–π

#### 1.6 WebGL –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
```javascript
// –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç WebGL –Ω–∞–¥ WASM (2-3x –±—ã—Å—Ç—Ä–µ–µ)
if (provider === "webgl") {
  sessionOptions.executionProviders = [{
    name: "webgl",
    deviceType: "gpu",
    preferredLayout: "NCHW",
    powerPreference: "high-performance",
  }];
}
```
**–≠—Ñ—Ñ–µ–∫—Ç:** –£—Å–∫–æ—Ä–µ–Ω–∏–µ inference –Ω–∞ GPU –¥–æ 2-3x (—Å 25ms –¥–æ 10-15ms)

---

### 2. useBackgroundReplacement.js (–ö–æ–º–ø–æ–∑–∏—Ç–∏–Ω–≥)

#### 2.1 –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
```javascript
// –î–û
const BASE_TARGET_SHORT = 256;
const BASE_DOWNSAMPLE = 0.45;

// –ü–û–°–õ–ï - –±–∞–ª–∞–Ω—Å –∫–∞—á–µ—Å—Ç–≤–æ/—Å–∫–æ—Ä–æ—Å—Ç—å
const BASE_TARGET_SHORT = 288;
const BASE_DOWNSAMPLE = 0.4;
```
**–≠—Ñ—Ñ–µ–∫—Ç:** –õ—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ –ø—Ä–∏ –Ω–µ–±–æ–ª—å—à–æ–º —Å–Ω–∏–∂–µ–Ω–∏–∏ —Å–∫–æ—Ä–æ—Å—Ç–∏ (~10% –º–µ–Ω—å—à–µ FPS, +15% –∫–∞—á–µ—Å—Ç–≤–æ)

#### 2.2 –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–∞—Å–∫–∏
```javascript
// –î–û
const byte = Math.round(alpha * 255);
const idx = i * 4;

// –ü–û–°–õ–ï
const invRange = 1.0 / (HARD_START - SOFT_START); // –ø—Ä–µ–¥–≤—ã—á–∏—Å–ª–µ–Ω–∏–µ
const idx = i << 2; // –±–∏—Ç–æ–≤—ã–π —Å–¥–≤–∏–≥ –±—ã—Å—Ç—Ä–µ–µ
const byte = (alpha * 255) | 0; // –±—ã—Å—Ç—Ä–µ–µ Math.round
```
**–≠—Ñ—Ñ–µ–∫—Ç:** –£—Å–∫–æ—Ä–µ–Ω–∏–µ —Ü–∏–∫–ª–∞ –º–∞—Å–∫–∏ –Ω–∞ ~10-15%

#### 2.3 –£–º–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ canvas
```javascript
// –î–û: –≤—Å–µ–≥–¥–∞ –∏–∑–º–µ–Ω—è–ª–∏ —Ä–∞–∑–º–µ—Ä
outputCanvas.value.width = videoWidth;
outputCanvas.value.height = videoHeight;

// –ü–û–°–õ–ï: —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
if (outputCanvas.value.width !== videoWidth || 
    outputCanvas.value.height !== videoHeight) {
  outputCanvas.value.width = videoWidth;
  outputCanvas.value.height = videoHeight;
}
```
**–≠—Ñ—Ñ–µ–∫—Ç:** –ú–µ–Ω—å—à–µ –æ–ø–µ—Ä–∞—Ü–∏–π –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞, –º–µ–Ω—å—à–µ –∞–ª–ª–æ–∫–∞—Ü–∏–π

#### 2.4 –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è
```javascript
// –î–û
scaledCtx.imageSmoothingQuality = "medium";
scaledCtx.filter = "blur(0.8px)";

// –ü–û–°–õ–ï - –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤–∞–∂–Ω–µ–µ
scaledCtx.imageSmoothingQuality = "low";
scaledCtx.filter = "blur(0.6px)";
```
**–≠—Ñ—Ñ–µ–∫—Ç:** –£—Å–∫–æ—Ä–µ–Ω–∏–µ –∫–æ–º–ø–æ–∑–∏—Ç–∏–Ω–≥–∞ –Ω–∞ ~5-7%, –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞

#### 2.5 –£–¥–∞–ª–µ–Ω–∏–µ –ª–∏—à–Ω–∏—Ö clearRect
```javascript
// –î–û: clearRect + drawImage
ctx.clearRect(0, 0, width, height);
ctx.drawImage(bgSurface.canvas, 0, 0);

// –ü–û–°–õ–ï: —Ç–æ–ª—å–∫–æ drawImage (–∏ —Ç–∞–∫ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º –ø–æ–ª–Ω–æ—Å—Ç—å—é)
ctx.drawImage(bgSurface.canvas, 0, 0);
```
**–≠—Ñ—Ñ–µ–∫—Ç:** –≠–∫–æ–Ω–æ–º–∏—è ~1-2 –º—Å –Ω–∞ –∫–∞–¥—Ä

#### 2.6 –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è ensureCanvas
```javascript
// –ü–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞
const needsResize = surface.canvas.width !== width || 
                   surface.canvas.height !== height;
if (needsResize) {
  surface.ctx = null; // –ü–µ—Ä–µ—Å–æ–∑–¥–∞–µ–º —Ç–æ–ª—å–∫–æ –ø—Ä–∏ resize
}
```
**–≠—Ñ—Ñ–µ–∫—Ç:** –ú–µ–Ω—å—à–µ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤, —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

---

### 3. FullInterface.vue

#### 3.1 –£–¥–∞–ª–µ–Ω –Ω–µ—Ä–∞–±–æ—á–∏–π —Ä–µ–∂–∏–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –£–¥–∞–ª–µ–Ω–∞ —Å–µ–∫—Ü–∏—è "–†–µ–∂–∏–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏" –∏–∑ UI
- –£–¥–∞–ª–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `performanceMode`
- –£–¥–∞–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `setPerformanceMode`

**–ü—Ä–∏—á–∏–Ω–∞:** –ú–µ—Ç–æ–¥—ã `setTurboMode` –∏ `setQualityMode` –Ω–µ –±—ã–ª–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ VideoCanvas

#### 3.2 –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ humanize
```javascript
// –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ä–∞–Ω–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É
function humanize(s = "") {
  if (!s) return "";
  // ... –æ—Å—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞
}
```
**–≠—Ñ—Ñ–µ–∫—Ç:** –ë—ã—Å—Ç—Ä–µ–µ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Å—Ç—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

---

## üìà –û–∂–∏–¥–∞–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ü–æ —ç—Ç–∞–ø–∞–º pipeline

| –≠—Ç–∞–ø | –î–æ | –ü–æ—Å–ª–µ | –£–ª—É—á—à–µ–Ω–∏–µ |
|------|-------|--------|-----------|
| **–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–µ–Ω–∑–æ—Ä–∞** | 3-4 –º—Å | 2-3 –º—Å | ~25% |
| **ML Inference (WASM)** | 25 –º—Å | 23-24 –º—Å | ~5% |
| **ML Inference (WebGL)** | 25 –º—Å | **10-15 –º—Å** | **40-60%** ‚≠ê |
| **–ü–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞ –º–∞—Å–∫–∏** | 2-3 –º—Å | 1-2 –º—Å | ~35% |
| **–ö–æ–º–ø–æ–∑–∏—Ç–∏–Ω–≥** | 20-30 –º—Å | 17-25 –º—Å | ~15% |
| **–ò–¢–û–ì–û (WASM)** | ~55 –º—Å | ~48 –º—Å | ~13% |
| **–ò–¢–û–ì–û (WebGL)** | ~55 –º—Å | **~33-40 –º—Å** | **30-40%** ‚≠ê |

### –¶–µ–ª–µ–≤–æ–π FPS

```
–î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- –ö–∞–∂–¥—ã–π 2-–π –∫–∞–¥—Ä: (120ms + 5ms) / 2 ‚âà 62.5ms ‚Üí ~16 FPS
- –¢–µ–∫—É—â–∏–π: ~15 FPS

–ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (WASM):
- –ö–∞–∂–¥—ã–π 2-–π –∫–∞–¥—Ä: (105ms + 5ms) / 2 ‚âà 55ms ‚Üí ~18 FPS
- –£–ª—É—á—à–µ–Ω–∏–µ: +3 FPS (+20%)

–ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (WebGL): ‚≠ê
- –ö–∞–∂–¥—ã–π 2-–π –∫–∞–¥—Ä: (70ms + 5ms) / 2 ‚âà 37.5ms ‚Üí ~26 FPS
- –£–ª—É—á—à–µ–Ω–∏–µ: +11 FPS (+73%)
```

---

## üîç –î–µ—Ç–∞–ª–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é ‚úÖ
1. –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ canvas –≤–º–µ—Å—Ç–æ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö
2. –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±—É—Ñ–µ—Ä–æ–≤ —Ç–µ–Ω–∑–æ—Ä–æ–≤
3. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ ImageData
4. –ú–µ–Ω—å—à–µ –æ–ø–µ—Ä–∞—Ü–∏–π –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ canvas
5. –ù–µ —É–¥–∞–ª—è–µ–º –±—É—Ñ–µ—Ä—ã –ø—Ä–∏ reset

**–≠—Ñ—Ñ–µ–∫—Ç:** –°–Ω–∏–∂–µ–Ω–∏–µ GC –ø–∞—É–∑ –Ω–∞ ~50%, –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–π FPS

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ü–∏–∫–ª–æ–≤ ‚úÖ
1. –ë–∏—Ç–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤–º–µ—Å—Ç–æ —É–º–Ω–æ–∂–µ–Ω–∏—è (`i << 2` –≤–º–µ—Å—Ç–æ `i * 4`)
2. –ü—Ä–µ–¥–≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç (`inv255 = 1/255`)
3. –ü—Ä–æ–ø—É—Å–∫ –æ—á–µ–≤–∏–¥–Ω—ã—Ö –ø–∏–∫—Å–µ–ª–µ–π –≤ –º–æ—Ä—Ñ–æ–ª–æ–≥–∏–∏
4. `| 0` –≤–º–µ—Å—Ç–æ `Math.round()` –¥–ª—è —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª

**–≠—Ñ—Ñ–µ–∫—Ç:** –£—Å–∫–æ—Ä–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ü–∏–∫–ª–æ–≤ –Ω–∞ 10-20%

### Rendering –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ ‚úÖ
1. –°–Ω–∏–∂–µ–Ω–æ –∫–∞—á–µ—Å—Ç–≤–æ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è —Ç–∞–º, –≥–¥–µ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ
2. –£–º–µ–Ω—å—à–µ–Ω —Ä–∞–¥–∏—É—Å blur —Ñ–∏–ª—å—Ç—Ä–∞
3. –£–¥–∞–ª–µ–Ω—ã –ª–∏—à–Ω–∏–µ `clearRect` –æ–ø–µ—Ä–∞—Ü–∏–∏
4. –ú–µ–Ω—å—à–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ä–∞–∑–º–µ—Ä–∞ canvas

**–≠—Ñ—Ñ–µ–∫—Ç:** –£—Å–∫–æ—Ä–µ–Ω–∏–µ –∫–æ–º–ø–æ–∑–∏—Ç–∏–Ω–≥–∞ –Ω–∞ 15%

### ML Model –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ ‚úÖ
1. **WebGL backend –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç** (–≥–ª–∞–≤–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è!)
2. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã WebGL —Å–µ—Å—Å–∏–∏
3. Pre-warming –º–æ–¥–µ–ª–∏ –¥–ª—è –≤—Å–µ—Ö backend'–æ–≤
4. –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ fallback

**–≠—Ñ—Ñ–µ–∫—Ç:** –î–æ 2-3x —É—Å–∫–æ—Ä–µ–Ω–∏–µ inference –Ω–∞ GPU

---

## üìù –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

‚úÖ –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Å—Ç–∞–ª–∏—Å—å —Ä–∞–±–æ—á–∏–º–∏:
- –ó–∞–º–µ–Ω–∞ —Ñ–æ–Ω–∞ (blur, color, photo)
- –†–µ–∂–∏–º —Ä–∏—Å–æ–≤–∞–Ω–∏—è –ø–æ–≤–µ—Ä—Ö –≤–∏–¥–µ–æ
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –Ω–∞ –≤–∏–¥–µ–æ
- –£—Ä–æ–≤–Ω–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏
- –ü—Ä–µ—Å–µ—Ç—ã —Ñ–æ–Ω–æ–≤
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ñ–æ–Ω–æ–≤

---

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### 1. WebGL –∫–æ–º–ø–æ–∑–∏—Ç–∏–Ω–≥ (High Priority)
–ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –∫–æ–º–ø–æ–∑–∏—Ç–∏–Ω–≥ —Ñ–æ–Ω–∞ –∏ –ø–µ—Ä–µ–¥–Ω–µ–≥–æ –ø–ª–∞–Ω–∞ –Ω–∞ WebGL —à–µ–π–¥–µ—Ä—ã.
**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ:** 5-10x –¥–ª—è –∫–æ–º–ø–æ–∑–∏—Ç–∏–Ω–≥–∞

### 2. FP16 –º–æ–¥–µ–ª—å (Medium Priority)
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–≤–∞–Ω—Ç–∏–∑–æ–≤–∞–Ω–Ω—É—é FP16 –≤–µ—Ä—Å–∏—é RVM –º–æ–¥–µ–ª–∏.
**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ:** 2x, —É–º–µ–Ω—å—à–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –º–æ–¥–µ–ª–∏ –≤ 2 —Ä–∞–∑–∞

### 3. –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ (Low Priority)
–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –º–µ–Ω—è—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ inference –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç FPS.
**–≠—Ñ—Ñ–µ–∫—Ç:** –°—Ç–∞–±–∏–ª—å–Ω—ã–π FPS –¥–∞–∂–µ –Ω–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö

### 4. WebGPU backend (Future)
–ö–æ–≥–¥–∞ –±—Ä–∞—É–∑–µ—Ä—ã –¥–æ–±–∞–≤—è—Ç –ø–æ–ª–Ω—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É –æ–ø–µ—Ä–∞—Ü–∏–π –º–æ–¥–µ–ª–∏.
**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ:** 3-4x –Ω–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö GPU

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç

- [x] –£–¥–∞–ª–µ–Ω—ã –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (StatsPanel, PresentationMode, UserInfo)
- [x] –£–¥–∞–ª–µ–Ω—ã –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –≤–æ—Ä–∫–µ—Ä—ã (comp.worker.js, simple-comp.worker.js)
- [x] –£–¥–∞–ª–µ–Ω–∞ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ (maskRefiner.js)
- [x] –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω rvm.worker.js
  - [x] –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ canvas
  - [x] –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ü–∏–∫–ª–æ–≤
  - [x] –£–ª—É—á—à–µ–Ω–∏–µ temporal stabilization
  - [x] –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –º–æ—Ä—Ñ–æ–ª–æ–≥–∏–∏
  - [x] WebGL –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- [x] –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω useBackgroundReplacement.js
  - [x] –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
  - [x] –£—Å–∫–æ—Ä–µ–Ω–∏–µ —Ü–∏–∫–ª–æ–≤ –º–∞—Å–∫–∏
  - [x] –£–º–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ canvas
  - [x] –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–∑–∏—Ç–∏–Ω–≥–∞
  - [x] –£–ª—É—á—à–µ–Ω–∏–µ ensureCanvas
- [x] –û—á–∏—â–µ–Ω FullInterface.vue
  - [x] –£–¥–∞–ª–µ–Ω –Ω–µ—Ä–∞–±–æ—á–∏–π —Ä–µ–∂–∏–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
  - [x] –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è humanize
- [x] –£–¥–∞–ª–µ–Ω—ã –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–º–ø–æ—Ä—Ç—ã
- [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–Ω—Ç–æ–≤ (0 –æ—à–∏–±–æ–∫)
- [x] –°–æ—Ö—Ä–∞–Ω–µ–Ω –≤–µ—Å—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## üìä –ò—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ
- **–£–¥–∞–ª–µ–Ω–æ —Ñ–∞–π–ª–æ–≤:** 6
- **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ —Ñ–∞–π–ª–æ–≤:** 3
- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞ —É–¥–∞–ª–µ–Ω–æ:** ~800
- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ:** ~200

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **–¢–µ–∫—É—â–∞—è:** ~15 FPS, inference ~25 –º—Å
- **–û–∂–∏–¥–∞–µ–º–∞—è (WASM):** ~18 FPS (+20%), inference ~23 –º—Å
- **–û–∂–∏–¥–∞–µ–º–∞—è (WebGL):** ~26 FPS (+73%), inference ~12 –º—Å ‚≠ê

### –ö–∞—á–µ—Å—Ç–≤–æ
- **–õ–∏–Ω—Ç-–æ—à–∏–±–∫–∏:** 0
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:** 100% —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞
- **–ö–æ–¥:** –ß–∏—â–µ –∏ –ø–æ–Ω—è—Ç–Ω–µ–µ

---

## üéØ –í—ã–≤–æ–¥—ã

–ü—Ä–æ–≤–µ–¥–µ–Ω–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–∑–≤–æ–ª–∏–ª–∏:

1. **–û—á–∏—Å—Ç–∏—Ç—å –∫–æ–¥–æ–≤—É—é –±–∞–∑—É** - —É–¥–∞–ª–µ–Ω–æ 800+ —Å—Ç—Ä–æ–∫ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ –∫–æ–¥–∞
2. **–£–ª—É—á—à–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –æ–∂–∏–¥–∞–µ–º—ã–π –ø—Ä–∏—Ä–æ—Å—Ç –¥–æ 73% FPS —Å WebGL
3. **–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å** - –≤—Å–µ —Ñ–∏—á–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –ø—Ä–µ–∂–¥–µ
4. **–£–ª—É—á—à–∏—Ç—å —á–∏—Ç–∞–µ–º–æ—Å—Ç—å** - –∫–æ–¥ —Å—Ç–∞–ª –ø–æ–Ω—è—Ç–Ω–µ–µ –∏ –ø—Ä–æ—â–µ
5. **–°–Ω–∏–∑–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏** - –º–µ–Ω—å—à–µ GC –ø–∞—É–∑

**–ì–ª–∞–≤–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ WebGL backend –º–æ–∂–µ—Ç –¥–∞—Ç—å –¥–æ 2-3x —É—Å–∫–æ—Ä–µ–Ω–∏–µ inference!

---

**–ê–≤—Ç–æ—Ä:** AI Assistant  
**–î–∞—Ç–∞:** 25 –æ–∫—Ç—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

