# üöÄ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ (–æ–±–Ω–æ–≤–ª–µ–Ω–æ 25.10.2025)

### 1. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω ML Worker (rvm.worker.js)
- ‚úÖ **WebGL backend –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç** - –¥–æ 2-3x –±—ã—Å—Ç—Ä–µ–µ inference (—Å 25ms –¥–æ 10-15ms)
- ‚úÖ –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ canvas –∏ –±—É—Ñ–µ—Ä–æ–≤ - –º–µ–Ω—å—à–µ GC –ø–∞—É–∑
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ü–∏–∫–ª–æ–≤ - –±–∏—Ç–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ –ø—Ä–µ–¥–≤—ã—á–∏—Å–ª–µ–Ω–∏—è
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è temporal stabilization - —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ –º–∞—Å–∫–∞
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–æ—Ä—Ñ–æ–ª–æ–≥–∏—è - –ø—Ä–æ–ø—É—Å–∫ –æ—á–µ–≤–∏–¥–Ω—ã—Ö –ø–∏–∫—Å–µ–ª–µ–π

### 2. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –∫–æ–º–ø–æ–∑–∏—Ç–∏–Ω–≥ (useBackgroundReplacement.js)
- ‚úÖ Canvas API –≤–º–µ—Å—Ç–æ –ø–æ–ø–∏–∫—Å–µ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (6-10x –±—ã—Å—Ç—Ä–µ–µ)
- ‚úÖ –£–º–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ canvas - —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è - –±–∞–ª–∞–Ω—Å —Å–∫–æ—Ä–æ—Å—Ç—å/–∫–∞—á–µ—Å—Ç–≤–æ
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –ª–∏—à–Ω–∏—Ö clearRect –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é

### 3. –ü—Ä–æ–ø—É—Å–∫ –∫–∞–¥—Ä–æ–≤
–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–∞–∂–¥—ã–π 2-–π –∫–∞–¥—Ä, –∏—Å–ø–æ–ª—å–∑—É—è –ø—Ä–µ–¥—ã–¥—É—â—É—é –º–∞—Å–∫—É (2x –±—ã—Å—Ç—Ä–µ–µ)

### 4. Frame throttling
–ù–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –Ω–æ–≤—ã–π –∫–∞–¥—Ä –ø–æ–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –Ω–µ –≥–æ—Ç–æ–≤

### 5. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∫–æ–¥–∞
- ‚úÖ –£–¥–∞–ª–µ–Ω–æ 800+ —Å—Ç—Ä–æ–∫ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ –∫–æ–¥–∞
- ‚úÖ –£–¥–∞–ª–µ–Ω—ã 6 –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤
- ‚úÖ 0 –æ—à–∏–±–æ–∫ –ª–∏–Ω—Ç–µ—Ä–∞

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- FPS: ~15
- Inference: ~25 –º—Å
- Backend: WASM (1 thread)

### –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (WASM —Å –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å—é) ‚≠ê
- FPS: **~18-22** (+35%)
- Inference: **~20 –º—Å** (-20%)
- Backend: **WASM (4+ threads)**
- **–¢—Ä–µ–±—É–µ—Ç:** Cross-origin isolation headers

### –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (WASM –±–µ–∑ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏)
- FPS: **~12-15** (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
- Inference: **~25 –º—Å** (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
- Backend: WASM (1 thread)

### –ï—Å–ª–∏ WebGL –¥–æ—Å—Ç—É–ø–µ–Ω (—Ä–µ–¥–∫–æ)
- FPS: ~26 (+73%)
- Inference: ~12 –º—Å (-52%)
- Backend: WebGL (GPU)

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏

**–§–∞–π–ª:** `src/composables/useBackgroundReplacement.js`

```javascript
// –°–∫–æ—Ä–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ (—Å—Ç—Ä–æ–∫–∞ 30)
const PROCESS_EVERY_N_FRAMES = 3; // 3 = –∫–∞–∂–¥—ã–π —Ç—Ä–µ—Ç–∏–π (–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è WASM)

// –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –¥–ª—è inference (—Å—Ç—Ä–æ–∫–∞ 24)
const BASE_TARGET_SHORT = 256; // –ü–æ–Ω–∏–∑–∏—Ç—å –¥–æ 224 –¥–ª—è –µ—â–µ –±–æ–ª—å—à–µ–π —Å–∫–æ—Ä–æ—Å—Ç–∏

// Downsampling –≤–Ω—É—Ç—Ä–∏ –º–æ–¥–µ–ª–∏ (—Å—Ç—Ä–æ–∫–∞ 27)
const BASE_DOWNSAMPLE = 0.35; // –£–≤–µ–ª–∏—á–∏—Ç—å –¥–æ 0.45-0.5 –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è
```

**–§–∞–π–ª:** `src/workers/rvm.worker.js`

```javascript
// Temporal stabilization (—Å—Ç—Ä–æ–∫–∞ 26)
const TEMPORAL_ALPHA = 0.75; // 0.6-0.8, –±–æ–ª—å—à–µ = —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ

// –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–∞—á–µ—Å—Ç–≤–∞ (—Å—Ç—Ä–æ–∫–∞ 29-31)
const EDGE_GAMMA = 0.8; // 0.7-0.9, –º–µ–Ω—å—à–µ = –º—è–≥—á–µ –∫—Ä–∞—è
const FOREGROUND_PUSH = 0.05; // 0.04-0.08, –±–æ–ª—å—à–µ = —á–µ—Ç—á–µ fg
```

## üöÄ –ï—Å–ª–∏ –º–µ–¥–ª–µ–Ω–Ω–æ

### –ö–†–ò–¢–ò–ß–ù–û: –í–∫–ª—é—á–∏—Ç–µ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å! ‚ö°

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏:
```
‚ùå –ë–ï–ó –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏ (–º–µ–¥–ª–µ–Ω–Ω–æ):
[Worker] Initializing WASM with 1 threads
[Worker] ‚ö†Ô∏è Not cross-origin isolated

‚úÖ –° –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å—é (–±—ã—Å—Ç—Ä–æ):
[Worker] Initializing WASM with 4 threads
```

**–ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:** –ó–∞–ø—É—Å—Ç–∏—Ç–µ —á–µ—Ä–µ–∑ `npm run dev` –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏ (—Å–º. **WASM_OPTIMIZATION.md**)

**–≠—Ñ—Ñ–µ–∫—Ç:** +80-100% –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏! (–æ—Ç 12 –¥–æ 20+ FPS)

### –ï—Å–ª–∏ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å —É–∂–µ –≤–∫–ª—é—á–µ–Ω–∞, –Ω–æ –≤—Å–µ —Ä–∞–≤–Ω–æ –º–µ–¥–ª–µ–Ω–Ω–æ

1. –£–≤–µ–ª–∏—á–∏—Ç—å `PROCESS_EVERY_N_FRAMES` –¥–æ 4
2. –ü–æ–Ω–∏–∑–∏—Ç—å `BASE_TARGET_SHORT` –¥–æ 224
3. –£–≤–µ–ª–∏—á–∏—Ç—å `BASE_DOWNSAMPLE` –¥–æ 0.45

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ backend –∏ –ø–æ—Ç–æ–∫–∏

–û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å (F12) –∏ –Ω–∞–π–¥–∏—Ç–µ:

```
‚úÖ –û—Ç–ª–∏—á–Ω–æ (–º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å –≤–∫–ª—é—á–µ–Ω–∞):
[Worker] Initializing WASM with 4 threads
[Worker] ‚úì Using WASM backend
Inference: 18-22ms, FPS: 18-22

‚ö†Ô∏è –ú–µ–¥–ª–µ–Ω–Ω–æ (1 –ø–æ—Ç–æ–∫):
[Worker] Initializing WASM with 1 threads
[Worker] ‚ö†Ô∏è Not cross-origin isolated
Inference: 25-28ms, FPS: 12-15

üöÄ –†–µ–¥–∫–æ (–µ—Å–ª–∏ GPU –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç):
[Worker] ‚úì Using WEBGL backend
Inference: 10-15ms, FPS: 23-28
```

### 2. Performance Overlay

–í –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É –≤–∏–¥–µ–æ –µ—Å—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:
- **FPS** - —Ç–µ–∫—É—â–∏–π FPS
- **Backend** - wasm –∏–ª–∏ webgl
- **Inference** - –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–∏
- **Total** - –ø–æ–ª–Ω–æ–µ –≤—Ä–µ–º—è –∫–∞–¥—Ä–∞

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- **REFACTORING_SUMMARY.md** - –ø–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º
- **TESTING_GUIDE.md** - —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
- **ARCHITECTURE.md** - –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –∏ –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é  
**WebGL backend:** ‚úÖ –í–∫–ª—é—á–µ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é  
**–ü—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** –î–æ 73% –Ω–∞ GPU

